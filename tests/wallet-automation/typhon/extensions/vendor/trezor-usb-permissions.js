const VERSION="8.1.25",versionN=VERSION.split(".").map((e=>parseInt(e,10))),DIRECTORY=`${versionN[0]}/`,url=`https://connect.trezor.io/${DIRECTORY}`;function switchToPopupTab(e){window.removeEventListener("beforeunload",switchToPopupTab),e||chrome.tabs.query({currentWindow:!0,active:!0},(e=>{e.length<0||chrome.tabs.remove(e[0].id)})),chrome.tabs.query({url:`${url}popup.html`},(e=>{e.length<0||chrome.tabs.update(e[0].id,{active:!0})}))}window.addEventListener("message",(e=>{if("usb-permissions-init"===e.data){const e=document.getElementById("trezor-usb-permissions");if(!e||!(e instanceof HTMLIFrameElement))throw new Error("trezor-usb-permissions missing or incorrect dom type");e.contentWindow.postMessage({type:"usb-permissions-init",extension:chrome.runtime.id},"*")}else"usb-permissions-close"===e.data&&switchToPopupTab()})),window.addEventListener("beforeunload",switchToPopupTab),window.addEventListener("load",(()=>{const e=document.createElement("iframe");e.id="trezor-usb-permissions",e.frameBorder="0",e.width="100%",e.height="100%",e.style.border="0px",e.style.width="100%",e.style.height="100%",e.setAttribute("src",`${url}extension-permissions.html`),e.setAttribute("allow","usb"),document.body&&document.body.appendChild(e)}));